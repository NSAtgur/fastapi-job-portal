<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HireFlow ‚Äî Job Portal</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0a0a0f;
      --surface: #111118;
      --surface2: #1a1a24;
      --border: #2a2a38;
      --accent: #e8ff47;
      --accent2: #7c6aff;
      --text: #f0f0f8;
      --muted: #888899;
      --danger: #ff4f6a;
      --success: #47ffb0;
      --warning: #ffb347;
      --radius: 12px;
      --font-head: 'Syne', sans-serif;
      --font-body: 'DM Sans', sans-serif;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ */
    #toast-container {
      position: fixed; top: 24px; right: 24px; z-index: 9999;
      display: flex; flex-direction: column; gap: 10px;
    }
    .toast {
      background: var(--surface2); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 14px 18px;
      font-size: 14px; min-width: 260px; max-width: 360px;
      display: flex; align-items: center; gap: 10px;
      animation: slideIn 0.3s ease;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    }
    .toast.success { border-left: 3px solid var(--success); }
    .toast.error   { border-left: 3px solid var(--danger); }
    .toast.info    { border-left: 3px solid var(--accent2); }
    .toast.ws      { border-left: 3px solid var(--accent); }
    @keyframes slideIn { from { opacity:0; transform:translateX(40px); } to { opacity:1; transform:translateX(0); } }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ NAV ‚îÄ‚îÄ‚îÄ‚îÄ */
    nav {
      position: sticky; top: 0; z-index: 100;
      background: rgba(10,10,15,0.9); backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
      padding: 0 40px; height: 64px;
      display: flex; align-items: center; justify-content: space-between;
    }
    .nav-logo {
      font-family: var(--font-head); font-size: 22px; font-weight: 800;
      color: var(--accent); letter-spacing: -0.5px; cursor: pointer;
    }
    .nav-logo span { color: var(--text); }
    .nav-links { display: flex; gap: 6px; align-items: center; }
    .nav-btn {
      background: none; border: none; color: var(--muted);
      font-family: var(--font-body); font-size: 14px;
      padding: 8px 16px; border-radius: 8px; cursor: pointer;
      transition: all 0.2s;
    }
    .nav-btn:hover, .nav-btn.active { background: var(--surface2); color: var(--text); }
    .nav-btn.primary {
      background: var(--accent); color: #000; font-weight: 600;
    }
    .nav-btn.primary:hover { background: #d4eb30; }
    .ws-dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--muted); display: inline-block; margin-right: 6px;
      transition: background 0.3s;
    }
    .ws-dot.connected { background: var(--success); box-shadow: 0 0 8px var(--success); }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ PAGES ‚îÄ‚îÄ‚îÄ‚îÄ */
    .page { display: none; min-height: calc(100vh - 64px); padding: 48px 40px; }
    .page.active { display: block; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ HOME ‚îÄ‚îÄ‚îÄ‚îÄ */
    .hero {
      max-width: 800px; margin: 60px auto; text-align: center;
    }
    .hero-tag {
      display: inline-block; background: var(--surface2); border: 1px solid var(--border);
      color: var(--accent); font-size: 12px; font-weight: 600; letter-spacing: 2px;
      text-transform: uppercase; padding: 6px 16px; border-radius: 100px; margin-bottom: 32px;
    }
    .hero h1 {
      font-family: var(--font-head); font-size: clamp(44px, 7vw, 80px);
      font-weight: 800; line-height: 1.05; letter-spacing: -2px; margin-bottom: 24px;
    }
    .hero h1 .hl { color: var(--accent); }
    .hero p { font-size: 18px; color: var(--muted); max-width: 500px; margin: 0 auto 40px; line-height: 1.6; }
    .hero-actions { display: flex; gap: 14px; justify-content: center; flex-wrap: wrap; }

    /* Search bar on home */
    .search-bar {
      display: flex; gap: 0; max-width: 560px; margin: 0 auto 64px;
      background: var(--surface); border: 1px solid var(--border); border-radius: 14px;
      overflow: hidden;
    }
    .search-bar input {
      flex: 1; background: none; border: none; color: var(--text);
      font-family: var(--font-body); font-size: 15px; padding: 16px 20px; outline: none;
    }
    .search-bar input::placeholder { color: var(--muted); }
    .search-bar button {
      background: var(--accent); border: none; color: #000; font-weight: 700;
      font-family: var(--font-body); font-size: 14px; padding: 0 28px; cursor: pointer;
      transition: background 0.2s;
    }
    .search-bar button:hover { background: #d4eb30; }

    /* Stats */
    .stats-row { display: flex; gap: 1px; max-width: 700px; margin: 0 auto 80px; background: var(--border); border-radius: var(--radius); overflow: hidden; }
    .stat-item { flex: 1; background: var(--surface); padding: 28px; text-align: center; }
    .stat-item .num { font-family: var(--font-head); font-size: 32px; font-weight: 800; color: var(--accent); }
    .stat-item .label { font-size: 13px; color: var(--muted); margin-top: 4px; }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ JOBS GRID ‚îÄ‚îÄ‚îÄ‚îÄ */
    .section-header {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 28px;
    }
    .section-title { font-family: var(--font-head); font-size: 28px; font-weight: 700; }
    .jobs-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 16px;
    }
    .job-card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 28px; cursor: pointer;
      transition: all 0.25s; position: relative; overflow: hidden;
    }
    .job-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, var(--accent2), var(--accent));
      transform: scaleX(0); transform-origin: left; transition: transform 0.3s;
    }
    .job-card:hover { border-color: var(--accent2); transform: translateY(-2px); box-shadow: 0 12px 40px rgba(0,0,0,0.3); }
    .job-card:hover::before { transform: scaleX(1); }
    .job-card .company { font-size: 12px; color: var(--accent); text-transform: uppercase; letter-spacing: 1.5px; font-weight: 600; margin-bottom: 10px; }
    .job-card .title { font-family: var(--font-head); font-size: 20px; font-weight: 700; margin-bottom: 12px; }
    .job-card .meta { display: flex; gap: 10px; flex-wrap: wrap; }
    .tag {
      font-size: 12px; padding: 4px 12px; border-radius: 100px;
      background: var(--surface2); border: 1px solid var(--border); color: var(--muted);
    }
    .tag.new { background: rgba(232,255,71,0.1); border-color: var(--accent); color: var(--accent); }
    .job-card .apply-btn {
      margin-top: 20px; width: 100%; padding: 12px; background: var(--surface2);
      border: 1px solid var(--border); border-radius: 8px; color: var(--text);
      font-family: var(--font-body); font-size: 14px; font-weight: 500; cursor: pointer;
      transition: all 0.2s;
    }
    .job-card .apply-btn:hover { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 700; }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ FORMS ‚îÄ‚îÄ‚îÄ‚îÄ */
    .form-wrap {
      max-width: 480px; margin: 0 auto;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 16px; padding: 40px;
    }
    .form-title {
      font-family: var(--font-head); font-size: 28px; font-weight: 800; margin-bottom: 8px;
    }
    .form-sub { color: var(--muted); font-size: 14px; margin-bottom: 32px; }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; font-size: 13px; font-weight: 500; color: var(--muted); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
    .form-group input, .form-group select {
      width: 100%; background: var(--surface2); border: 1px solid var(--border);
      border-radius: 8px; color: var(--text); font-family: var(--font-body);
      font-size: 15px; padding: 13px 16px; outline: none; transition: border 0.2s;
    }
    .form-group input:focus, .form-group select:focus { border-color: var(--accent2); }
    .form-group select option { background: var(--surface2); }
    .btn {
      width: 100%; padding: 14px; border-radius: 8px; border: none; cursor: pointer;
      font-family: var(--font-body); font-size: 15px; font-weight: 600; transition: all 0.2s;
    }
    .btn-primary { background: var(--accent); color: #000; }
    .btn-primary:hover { background: #d4eb30; }
    .btn-secondary { background: var(--surface2); color: var(--text); border: 1px solid var(--border); }
    .btn-secondary:hover { border-color: var(--accent2); }
    .btn-danger { background: var(--danger); color: #fff; }
    .btn-success { background: var(--success); color: #000; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .form-link { text-align: center; margin-top: 20px; font-size: 14px; color: var(--muted); }
    .form-link a { color: var(--accent); cursor: pointer; }
    .form-link a:hover { text-decoration: underline; }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ PROFILE / DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ */
    .dash-layout { display: grid; grid-template-columns: 280px 1fr; gap: 24px; max-width: 1200px; margin: 0 auto; }
    .profile-card {
      background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px; height: fit-content;
    }
    .avatar {
      width: 72px; height: 72px; border-radius: 50%; background: linear-gradient(135deg, var(--accent2), var(--accent));
      display: flex; align-items: center; justify-content: center;
      font-family: var(--font-head); font-size: 28px; font-weight: 800; color: #000; margin-bottom: 20px;
    }
    .profile-name { font-family: var(--font-head); font-size: 20px; font-weight: 700; margin-bottom: 4px; }
    .profile-email { font-size: 13px; color: var(--muted); margin-bottom: 16px; word-break: break-all; }
    .role-badge {
      display: inline-block; font-size: 11px; font-weight: 700; text-transform: uppercase;
      letter-spacing: 1px; padding: 4px 12px; border-radius: 100px;
    }
    .role-badge.user { background: rgba(124,106,255,0.15); color: var(--accent2); border: 1px solid var(--accent2); }
    .role-badge.recruiter { background: rgba(232,255,71,0.1); color: var(--accent); border: 1px solid var(--accent); }
    .role-badge.admin { background: rgba(255,79,106,0.1); color: var(--danger); border: 1px solid var(--danger); }
    .status-pill {
      display: inline-flex; align-items: center; gap: 6px; margin-top: 12px;
      font-size: 12px;
    }
    .status-pill.active { color: var(--success); }
    .status-pill.inactive { color: var(--danger); }

    .dash-main { }
    .panel {
      background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
      padding: 28px; margin-bottom: 20px;
    }
    .panel-title { font-family: var(--font-head); font-size: 18px; font-weight: 700; margin-bottom: 20px; }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ‚îÄ‚îÄ */
    .data-table { width: 100%; border-collapse: collapse; font-size: 14px; }
    .data-table th {
      text-align: left; color: var(--muted); font-size: 11px; text-transform: uppercase;
      letter-spacing: 1px; padding: 10px 16px; border-bottom: 1px solid var(--border); font-weight: 500;
    }
    .data-table td { padding: 14px 16px; border-bottom: 1px solid var(--border); vertical-align: middle; }
    .data-table tr:last-child td { border-bottom: none; }
    .data-table tr:hover td { background: var(--surface2); }
    .action-btn {
      font-size: 12px; padding: 5px 14px; border-radius: 6px; border: none; cursor: pointer;
      font-family: var(--font-body); font-weight: 600; margin-right: 6px; transition: all 0.2s;
    }
    .action-btn.activate { background: rgba(71,255,176,0.1); color: var(--success); border: 1px solid var(--success); }
    .action-btn.deactivate { background: rgba(255,79,106,0.1); color: var(--danger); border: 1px solid var(--danger); }
    .action-btn.activate:hover { background: var(--success); color: #000; }
    .action-btn.deactivate:hover { background: var(--danger); color: #fff; }

    /* App status */
    .app-status {
      font-size: 12px; padding: 4px 12px; border-radius: 100px; font-weight: 600;
    }
    .app-status.applied { background: rgba(124,106,255,0.15); color: var(--accent2); }

    /* Post job inline */
    .post-job-form { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .post-job-form .full { grid-column: 1/-1; }

    /* Pagination */
    .pagination { display: flex; gap: 8px; align-items: center; margin-top: 20px; }
    .page-btn {
      background: var(--surface2); border: 1px solid var(--border); color: var(--text);
      font-size: 13px; padding: 7px 14px; border-radius: 7px; cursor: pointer; transition: all 0.2s;
    }
    .page-btn:hover, .page-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 700; }
    .page-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    /* WS notifications panel */
    .notif-list { max-height: 300px; overflow-y: auto; }
    .notif-item {
      padding: 12px 16px; border-bottom: 1px solid var(--border);
      font-size: 14px; display: flex; align-items: flex-start; gap: 10px;
    }
    .notif-item:last-child { border-bottom: none; }
    .notif-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); margin-top: 5px; flex-shrink: 0; }
    .notif-time { font-size: 11px; color: var(--muted); margin-top: 2px; }
    .empty-state { text-align: center; padding: 48px; color: var(--muted); }
    .empty-state .icon { font-size: 40px; margin-bottom: 12px; }
    .empty-state p { font-size: 15px; }

    /* Loading spinner */
    .spinner {
      width: 32px; height: 32px; border: 3px solid var(--border);
      border-top-color: var(--accent); border-radius: 50%;
      animation: spin 0.7s linear infinite; margin: 40px auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Responsive */
    @media (max-width: 768px) {
      nav { padding: 0 20px; }
      .page { padding: 32px 20px; }
      .dash-layout { grid-template-columns: 1fr; }
      .post-job-form { grid-template-columns: 1fr; }
      .post-job-form .full { grid-column: 1; }
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--muted); }
  </style>
</head>
<body>

<!-- TOAST -->
<div id="toast-container"></div>

<!-- NAV -->
<nav>
  <div class="nav-logo" onclick="showPage('home')">Hire<span>Flow</span></div>
  <div class="nav-links" id="nav-links">
    <button class="nav-btn" onclick="showPage('home')">Home</button>
    <button class="nav-btn" onclick="showPage('jobs')">Browse Jobs</button>
    <div id="nav-auth-logged-out" style="display:flex;gap:6px;">
      <button class="nav-btn" onclick="showPage('login')">Login</button>
      <button class="nav-btn primary" onclick="showPage('register')">Register</button>
    </div>
    <div id="nav-auth-logged-in" style="display:none;gap:6px;align-items:center;">
      <span id="ws-indicator" style="font-size:13px;color:var(--muted);">
        <span class="ws-dot" id="ws-dot"></span>Live
      </span>
      <button class="nav-btn" onclick="showDashboard()">Dashboard</button>
      <button class="nav-btn" onclick="logout()" style="color:var(--danger);">Logout</button>
    </div>
  </div>
</nav>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ HOME PAGE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page active" id="page-home">
  <div class="hero">
    <div class="hero-tag">üöÄ The Modern Job Portal</div>
    <h1>Find Your Next<br><span class="hl">Big Opportunity</span></h1>
    <p>Connect with top companies. Apply instantly. Get notified in real-time.</p>
  </div>
  <div class="search-bar">
    <input type="text" id="home-search" placeholder="Search job titles..." />
    <button onclick="doHomeSearch()">Search</button>
  </div>
  <div class="stats-row">
    <div class="stat-item"><div class="num">‚àû</div><div class="label">Open Roles</div></div>
    <div class="stat-item"><div class="num">3</div><div class="label">User Roles</div></div>
    <div class="stat-item"><div class="num">‚ö°</div><div class="label">Real-time Alerts</div></div>
  </div>
  <div style="max-width:1100px;margin:0 auto;">
    <div class="section-header">
      <div class="section-title">Recent Jobs</div>
      <button class="nav-btn" onclick="showPage('jobs')">See all ‚Üí</button>
    </div>
    <div id="home-jobs-grid" class="jobs-grid"><div class="spinner"></div></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ BROWSE JOBS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-jobs">
  <div style="max-width:1100px;margin:0 auto;">
    <div class="section-header">
      <div class="section-title">Browse Jobs</div>
      <div class="search-bar" style="margin:0;width:360px;">
        <input type="text" id="jobs-search-input" placeholder="Filter by title..." />
        <button onclick="searchJobs()">Go</button>
      </div>
    </div>
    <div id="jobs-grid" class="jobs-grid"><div class="spinner"></div></div>
    <div class="pagination" id="jobs-pagination"></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-login">
  <div class="form-wrap">
    <div class="form-title">Welcome back</div>
    <div class="form-sub">Login to your HireFlow account</div>
    <div class="form-group">
      <label>Email</label>
      <input type="email" id="login-email" placeholder="you@email.com" />
    </div>
    <div class="form-group">
      <label>Password</label>
      <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
    </div>
    <button class="btn btn-primary" onclick="loginUser()">Login</button>
    <div class="form-link">No account? <a onclick="showPage('register')">Register here</a></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ REGISTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-register">
  <div class="form-wrap">
    <div class="form-title">Create account</div>
    <div class="form-sub">Join HireFlow today</div>
    <div class="form-group">
      <label>Email</label>
      <input type="email" id="reg-email" placeholder="you@email.com" />
    </div>
    <div class="form-group">
      <label>Password</label>
      <input type="password" id="reg-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
    </div>
    <div class="form-group">
      <label>Role</label>
      <select id="reg-role">
        <option value="user">Job Seeker</option>
        <option value="recruiter">Recruiter</option>
      </select>
    </div>
    <button class="btn btn-primary" onclick="registerUser()">Create Account</button>
    <div class="form-link">Already have one? <a onclick="showPage('login')">Login</a></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ USER DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-user-dash">
  <div class="dash-layout">
    <div>
      <div class="profile-card">
        <div class="avatar" id="user-avatar">U</div>
        <div class="profile-name" id="user-name">‚Äì</div>
        <div class="profile-email" id="user-email">‚Äì</div>
        <div class="role-badge user">Job Seeker</div>
        <div class="status-pill active" id="user-status"><span>‚óè</span> Active</div>
      </div>
    </div>
    <div class="dash-main">
      <!-- Notifications -->
      <div class="panel">
        <div class="panel-title">‚ö° Live Notifications</div>
        <div class="notif-list" id="user-notifs">
          <div class="empty-state"><div class="icon">üîî</div><p>No notifications yet</p></div>
        </div>
      </div>
      <!-- My Applications -->
      <div class="panel">
        <div class="panel-title">My Applications</div>
        <div id="user-applications"><div class="spinner"></div></div>
        <div class="pagination" id="user-apps-pagination"></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ RECRUITER DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-recruiter-dash">
  <div class="dash-layout">
    <div>
      <div class="profile-card">
        <div class="avatar" style="background:linear-gradient(135deg,var(--accent),var(--accent2));">R</div>
        <div class="profile-name" id="rec-name">‚Äì</div>
        <div class="profile-email" id="rec-email">‚Äì</div>
        <div class="role-badge recruiter">Recruiter</div>
        <div class="status-pill active"><span>‚óè</span> Active</div>
      </div>
    </div>
    <div class="dash-main">
      <!-- Post a Job -->
      <div class="panel">
        <div class="panel-title">Post a New Job</div>
        <div class="post-job-form">
          <div class="form-group">
            <label>Job Title</label>
            <input type="text" id="job-title" placeholder="e.g. Backend Engineer" />
          </div>
          <div class="form-group">
            <label>Company</label>
            <input type="text" id="job-company" placeholder="e.g. Acme Corp" />
          </div>
          <div class="full">
            <button class="btn btn-primary" style="width:auto;padding:12px 32px;" onclick="postJob()">Post Job ‚Üó</button>
          </div>
        </div>
      </div>
      <!-- Notifications -->
      <div class="panel">
        <div class="panel-title">‚ö° Live Notifications</div>
        <div class="notif-list" id="rec-notifs">
          <div class="empty-state"><div class="icon">üîî</div><p>No notifications yet</p></div>
        </div>
      </div>
      <!-- My Posts -->
      <div class="panel">
        <div class="panel-title">My Job Posts</div>
        <div id="rec-posts"><div class="spinner"></div></div>
        <div class="pagination" id="rec-posts-pagination"></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ADMIN DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="page" id="page-admin-dash">
  <div class="dash-layout">
    <div>
      <div class="profile-card">
        <div class="avatar" style="background:linear-gradient(135deg,var(--danger),var(--accent2));">A</div>
        <div class="profile-name" id="admin-name">‚Äì</div>
        <div class="profile-email" id="admin-email">‚Äì</div>
        <div class="role-badge admin">Admin</div>
        <div class="status-pill active"><span>‚óè</span> Active</div>
      </div>
    </div>
    <div class="dash-main">
      <!-- Notifications -->
      <div class="panel">
        <div class="panel-title">‚ö° Live Notifications</div>
        <div class="notif-list" id="admin-notifs">
          <div class="empty-state"><div class="icon">üîî</div><p>No notifications yet</p></div>
        </div>
      </div>
      <!-- Users Table -->
      <div class="panel">
        <div class="panel-title">All Users</div>
        <div id="admin-users-wrap"><div class="spinner"></div></div>
        <div class="pagination" id="admin-users-pagination"></div>
      </div>
    </div>
  </div>
</div>

<script>
  // ‚îÄ‚îÄ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ
  const BASE = 'https://fastapi-job-portal.onrender.com';
  const WS_BASE = 'wss://fastapi-job-portal.onrender.com';

  // ‚îÄ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ
  let token = localStorage.getItem('hf_token') || null;
  let currentUser = null;
  let ws = null;
  let notifications = [];
  let jobsPage = 1;
  let appsPage = 1;
  let recPostsPage = 1;
  let adminUsersPage = 1;
  const PAGE_SIZE = 6;

  // ‚îÄ‚îÄ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ‚îÄ
  function toast(msg, type = 'info') {
    const t = document.getElementById('toast-container');
    const d = document.createElement('div');
    d.className = `toast ${type}`;
    const icons = { success:'‚úÖ', error:'‚ùå', info:'‚ÑπÔ∏è', ws:'‚ö°' };
    d.innerHTML = `<span>${icons[type]||'‚ÑπÔ∏è'}</span><span>${msg}</span>`;
    t.appendChild(d);
    setTimeout(() => d.remove(), 4000);
  }

  function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-' + id)?.classList.add('active');
    window.scrollTo(0,0);
    if (id === 'jobs') loadJobsPage();
    if (id === 'home') loadHomeJobs();
  }

  function showDashboard() {
    if (!currentUser) return showPage('login');
    const role = currentUser.role;
    if (role === 'user') { loadUserDash(); showPage('user-dash'); }
    else if (role === 'recruiter') { loadRecruiterDash(); showPage('recruiter-dash'); }
    else if (role === 'admin') { loadAdminDash(); showPage('admin-dash'); }
  }

  async function api(path, opts = {}) {
    const headers = { 'Content-Type': 'application/json' };
    if (token) headers['Authorization'] = `Bearer ${token}`;
    const res = await fetch(BASE + path, { ...opts, headers: { ...headers, ...opts.headers } });
    if (!res.ok) {
      let err = 'Request failed';
      try { const j = await res.json(); err = j.detail || err; } catch(e){}
      throw new Error(err);
    }
    if (res.status === 204) return null;
    return res.json();
  }

  function timeAgo(dateStr) {
    if (!dateStr) return '';
    const d = new Date(dateStr);
    const diff = Math.floor((Date.now() - d) / 1000);
    if (diff < 60) return `${diff}s ago`;
    if (diff < 3600) return `${Math.floor(diff/60)}m ago`;
    return `${Math.floor(diff/3600)}h ago`;
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ‚îÄ‚îÄ
  function updateNavAuth() {
    const li = document.getElementById('nav-auth-logged-in');
    const lo = document.getElementById('nav-auth-logged-out');
    if (token && currentUser) {
      li.style.display = 'flex'; lo.style.display = 'none';
    } else {
      li.style.display = 'none'; lo.style.display = 'flex';
    }
  }

  async function loginUser() {
    const email = document.getElementById('login-email').value.trim();
    const pw = document.getElementById('login-password').value;
    if (!email || !pw) return toast('Fill in all fields', 'error');
    try {
      const body = new URLSearchParams({ username: email, password: pw });
      const res = await fetch(BASE + '/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body
      });
      if (!res.ok) { const j = await res.json(); throw new Error(j.detail); }
      const data = await res.json();
      token = data['access_token'];
      localStorage.setItem('hf_token', token);
      await fetchCurrentUser();
      updateNavAuth();
      toast('Logged in!', 'success');
      showDashboard();
      connectWS();
    } catch(e) { toast(e.message, 'error'); }
  }

  async function registerUser() {
    const email = document.getElementById('reg-email').value.trim();
    const pw = document.getElementById('reg-password').value;
    const role = document.getElementById('reg-role').value;
    if (!email || !pw) return toast('Fill in all fields', 'error');
    try {
      await api('/register', { method:'POST', body: JSON.stringify({ email, password: pw, role }) });
      toast('Account created! Please login.', 'success');
      showPage('login');
    } catch(e) { toast(e.message, 'error'); }
  }

  function logout() {
    token = null; currentUser = null;
    localStorage.removeItem('hf_token');
    if (ws) { ws.close(); ws = null; }
    document.getElementById('ws-dot').classList.remove('connected');
    updateNavAuth();
    showPage('home');
    toast('Logged out', 'info');
  }

  async function fetchCurrentUser() {
    // Try each profile endpoint
    for (const path of ['/profile/user', '/profile/recruiter', '/profile/admin']) {
      try {
        currentUser = await api(path);
        return;
      } catch(e) { /* try next */ }
    }
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ WEBSOCKET ‚îÄ‚îÄ‚îÄ‚îÄ
  function connectWS() {
    if (!token) return;
    if (ws && ws.readyState === WebSocket.OPEN) return;
    ws = new WebSocket(`${WS_BASE}/ws?token=${token}`);
    ws.onopen = () => {
      document.getElementById('ws-dot').classList.add('connected');
      toast('Live updates connected', 'ws');
    };
    ws.onmessage = (evt) => {
      try {
        const data = JSON.parse(evt.data);
        const msg = data.details || data.message || data.details || JSON.stringify(data);
        const notif = { msg, time: new Date().toLocaleTimeString() };
        notifications.unshift(notif);
        toast('‚ö° ' + msg, 'ws');
        renderNotifications();
      } catch(e) {}
    };
    ws.onclose = () => {
      document.getElementById('ws-dot').classList.remove('connected');
      // Reconnect after 5s
      setTimeout(() => { if (token) connectWS(); }, 5000);
    };
    ws.onerror = () => ws.close();
  }

  function renderNotifications() {
    const role = currentUser?.role;
    const panelId = role === 'user' ? 'user-notifs' : role === 'recruiter' ? 'rec-notifs' : 'admin-notifs';
    const panel = document.getElementById(panelId);
    if (!panel) return;
    if (notifications.length === 0) {
      panel.innerHTML = `<div class="empty-state"><div class="icon">üîî</div><p>No notifications yet</p></div>`;
      return;
    }
    panel.innerHTML = notifications.map(n => `
      <div class="notif-item">
        <div class="notif-dot"></div>
        <div><div>${n.msg}</div><div class="notif-time">${n.time}</div></div>
      </div>`).join('');
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ JOBS ‚îÄ‚îÄ‚îÄ‚îÄ
  async function loadHomeJobs() {
    const grid = document.getElementById('home-jobs-grid');
    grid.innerHTML = '<div class="spinner"></div>';
    try {
      // Search with a broad term to get recent jobs - fallback to empty
      const jobs = await api('/search?title=engineer&page=1&limit=6').catch(() => []);
      renderJobCards(grid, jobs, true);
    } catch(e) {
      grid.innerHTML = `<div class="empty-state"><div class="icon">üíº</div><p>Login to see jobs or search above</p></div>`;
    }
  }

  async function loadJobsPage() {
    const grid = document.getElementById('jobs-grid');
    grid.innerHTML = '<div class="spinner"></div>';
    const title = document.getElementById('jobs-search-input').value.trim() || 'engineer';
    const skip = (jobsPage - 1) * PAGE_SIZE;
    try {
      const jobs = await api(`/search?title=${encodeURIComponent(title)}&skip=${skip}&limit=${PAGE_SIZE}`);
      renderJobCards(grid, jobs, false);
      renderPagination('jobs-pagination', jobsPage, jobs.length === PAGE_SIZE, (p) => { jobsPage = p; loadJobsPage(); });
    } catch(e) {
      grid.innerHTML = `<div class="empty-state"><div class="icon">üîç</div><p>No results found</p></div>`;
    }
  }

  async function searchJobs() {
    jobsPage = 1; loadJobsPage();
  }

  async function doHomeSearch() {
    const val = document.getElementById('home-search').value.trim();
    if (!val) return;
    document.getElementById('jobs-search-input').value = val;
    showPage('jobs');
  }

  function renderJobCards(container, jobs, compact) {
    if (!jobs || jobs.length === 0) {
      container.innerHTML = `<div class="empty-state"><div class="icon">üíº</div><p>No jobs found</p></div>`;
      return;
    }
    container.innerHTML = jobs.map(j => `
      <div class="job-card">
        <div class="company">${j.company || 'Company'}</div>
        <div class="title">${j.title}</div>
        <div class="meta">
          <span class="tag">ID #${j.id}</span>
          <span class="tag new">New</span>
        </div>
        ${token ? `<button class="apply-btn" onclick="applyJob(${j.id}, this)">Apply Now ‚Üí</button>` : `<button class="apply-btn" onclick="showPage('login')">Login to Apply</button>`}
      </div>`).join('');
  }

  async function applyJob(jobId, btn) {
    if (!token) return showPage('login');
    btn.disabled = true; btn.textContent = 'Applying...';
    try {
      await api(`/apply/${jobId}`, { method: 'POST' });
      btn.textContent = '‚úì Applied!';
      btn.style.background = 'var(--success)';
      btn.style.color = '#000';
      toast('Application submitted!', 'success');
    } catch(e) {
      btn.disabled = false;
      btn.textContent = e.message.includes('409') || e.message.toLowerCase().includes('already') ? '‚úì Already Applied' : 'Apply Now ‚Üí';
      if (!e.message.toLowerCase().includes('already')) toast(e.message, 'error');
      else toast('Already applied to this job', 'info');
    }
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ USER DASH ‚îÄ‚îÄ‚îÄ‚îÄ
  async function loadUserDash() {
    const user = currentUser;
    document.getElementById('user-avatar').textContent = user.email[0].toUpperCase();
    document.getElementById('user-name').textContent = user.email.split('@')[0];
    document.getElementById('user-email').textContent = user.email;
    document.getElementById('user-status').innerHTML = user.is_active
      ? `<span>‚óè</span> Active` : `<span>‚óè</span> Inactive`;
    document.getElementById('user-status').className = `status-pill ${user.is_active ? 'active' : 'inactive'}`;
    loadUserApplications();
    renderNotifications();
  }

  async function loadUserApplications() {
    const wrap = document.getElementById('user-applications');
    wrap.innerHTML = '<div class="spinner"></div>';
    const skip = (appsPage - 1) * PAGE_SIZE;
    try {
      const apps = await api(`/profile/user/applications?skip=${skip}&limit=${PAGE_SIZE}`);
      if (!apps || apps.length === 0) {
        wrap.innerHTML = `<div class="empty-state"><div class="icon">üìã</div><p>No applications yet. <a style="color:var(--accent);cursor:pointer;" onclick="showPage('jobs')">Browse jobs ‚Üí</a></p></div>`;
        return;
      }
      wrap.innerHTML = `<table class="data-table">
        <thead><tr><th>Job ID</th><th>Status</th></tr></thead>
        <tbody>${apps.map(a => `
          <tr>
            <td>Job #${a.job_id}</td>
            <td><span class="app-status applied">${a.status}</span></td>
          </tr>`).join('')}
        </tbody></table>`;
      renderPagination('user-apps-pagination', appsPage, apps.length === PAGE_SIZE, (p) => { appsPage = p; loadUserApplications(); });
    } catch(e) { wrap.innerHTML = `<div class="empty-state"><div class="icon">‚ùå</div><p>${e.message}</p></div>`; }
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ RECRUITER DASH ‚îÄ‚îÄ‚îÄ‚îÄ
  async function loadRecruiterDash() {
    const user = currentUser;
    document.getElementById('rec-name').textContent = user.email.split('@')[0];
    document.getElementById('rec-email').textContent = user.email;
    loadRecruiterPosts();
    renderNotifications();
  }

  async function postJob() {
    const title = document.getElementById('job-title').value.trim();
    const company = document.getElementById('job-company').value.trim();
    if (!title || !company) return toast('Fill in all job details', 'error');
    try {
      await api('/postjob', { method:'POST', body: JSON.stringify({ title, company }) });
      toast(`Job "${title}" posted! Users notified.`, 'success');
      document.getElementById('job-title').value = '';
      document.getElementById('job-company').value = '';
      recPostsPage = 1; loadRecruiterPosts();
    } catch(e) { toast(e.message, 'error'); }
  }

  async function loadRecruiterPosts() {
    const wrap = document.getElementById('rec-posts');
    wrap.innerHTML = '<div class="spinner"></div>';
    const skip = (recPostsPage - 1) * PAGE_SIZE;
    try {
      const posts = await api(`/profile/recruiter/posts?skip=${skip}&limit=${PAGE_SIZE}`);
      if (!posts || posts.length === 0) {
        wrap.innerHTML = `<div class="empty-state"><div class="icon">üìù</div><p>No jobs posted yet</p></div>`;
        return;
      }
      wrap.innerHTML = `<table class="data-table">
        <thead><tr><th>Title</th><th>Company</th><th>ID</th></tr></thead>
        <tbody>${posts.map(p => `
          <tr>
            <td><strong>${p.title}</strong></td>
            <td>${p.company}</td>
            <td><span class="tag">#${p.id}</span></td>
          </tr>`).join('')}
        </tbody></table>`;
      renderPagination('rec-posts-pagination', recPostsPage, posts.length === PAGE_SIZE, (p) => { recPostsPage = p; loadRecruiterPosts(); });
    } catch(e) { wrap.innerHTML = `<div class="empty-state"><div class="icon">‚ùå</div><p>${e.message}</p></div>`; }
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ ADMIN DASH ‚îÄ‚îÄ‚îÄ‚îÄ
  async function loadAdminDash() {
    const user = currentUser;
    document.getElementById('admin-name').textContent = user.email.split('@')[0];
    document.getElementById('admin-email').textContent = user.email;
    loadAdminUsers();
    renderNotifications();
  }

  async function loadAdminUsers() {
    const wrap = document.getElementById('admin-users-wrap');
    wrap.innerHTML = '<div class="spinner"></div>';
    const skip = (adminUsersPage - 1) * PAGE_SIZE;
    try {
      const users = await api(`/admin/users?skip=${skip}&limit=${PAGE_SIZE}`);
      if (!users || users.length === 0) {
        wrap.innerHTML = `<div class="empty-state"><div class="icon">üë•</div><p>No users found</p></div>`;
        return;
      }
      wrap.innerHTML = `<table class="data-table">
        <thead><tr><th>Email</th><th>Role</th><th>Status</th><th>Actions</th></tr></thead>
        <tbody>${users.map(u => `
          <tr>
            <td>${u.email}</td>
            <td><span class="role-badge ${u.role}">${u.role}</span></td>
            <td><span class="status-pill ${u.is_active ? 'active' : 'inactive'}">
              ${u.is_active ? '‚óè Active' : '‚óè Inactive'}</span></td>
            <td>
              ${u.is_active
                ? `<button class="action-btn deactivate" onclick="toggleUser(${u.id}, 'deactivate')">Deactivate</button>`
                : `<button class="action-btn activate" onclick="toggleUser(${u.id}, 'activate')">Activate</button>`}
            </td>
          </tr>`).join('')}
        </tbody></table>`;
      renderPagination('admin-users-pagination', adminUsersPage, users.length === PAGE_SIZE, (p) => { adminUsersPage = p; loadAdminUsers(); });
    } catch(e) { wrap.innerHTML = `<div class="empty-state"><div class="icon">‚ùå</div><p>${e.message}</p></div>`; }
  }

  async function toggleUser(userId, action) {
    try {
      await api(`/admin/user/${action}?user_id=${userId}`, { method: 'PATCH' });
      toast(`User ${action}d successfully`, 'success');
      loadAdminUsers();
    } catch(e) { toast(e.message, 'error'); }
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ PAGINATION ‚îÄ‚îÄ‚îÄ‚îÄ
  function renderPagination(containerId, currentPage, hasNext, onChange) {
    const c = document.getElementById(containerId);
    if (!c) return;
    c.innerHTML = '';
    if (currentPage === 1 && !hasNext) return;
    const prev = document.createElement('button');
    prev.className = 'page-btn'; prev.textContent = '‚Üê Prev';
    prev.disabled = currentPage === 1;
    prev.onclick = () => onChange(currentPage - 1);
    c.appendChild(prev);

    const label = document.createElement('span');
    label.style.cssText = 'font-size:13px;color:var(--muted);padding:0 8px;';
    label.textContent = `Page ${currentPage}`;
    c.appendChild(label);

    const next = document.createElement('button');
    next.className = 'page-btn'; next.textContent = 'Next ‚Üí';
    next.disabled = !hasNext;
    next.onclick = () => onChange(currentPage + 1);
    c.appendChild(next);
  }

  // ‚îÄ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ
  async function init() {
    if (token) {
      try {
        await fetchCurrentUser();
        updateNavAuth();
        connectWS();
      } catch(e) {
        token = null; localStorage.removeItem('hf_token');
        updateNavAuth();
      }
    } else {
      updateNavAuth();
    }
    loadHomeJobs();
  }

  // Enter key support
  document.getElementById('jobs-search-input')?.addEventListener('keydown', e => { if(e.key==='Enter') searchJobs(); });
  document.getElementById('home-search')?.addEventListener('keydown', e => { if(e.key==='Enter') doHomeSearch(); });
  document.getElementById('login-password')?.addEventListener('keydown', e => { if(e.key==='Enter') loginUser(); });

  init();
</script>
</body>
</html>